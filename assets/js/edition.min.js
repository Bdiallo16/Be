function Fichier(){this.id;this.nom;this.date;this.heure;this.retard;this.getInfos=function(e){this.id=$(e).find("[data-fichier-id]").attr("data-fichier-id");this.nom=$(e).find(".fichier-name").val();this.date=$(e).find(".fichier-date").val();this.heure=$(e).find(".fichier-heure").val();this.retard=$(e).find(".fichier-retard").find("input:checked").val()}}function Devoir(){this.id;this.nom;this.groupe;this.fichiers;this.getInfos=function(e){this.id=$(e).find("[data-devoir-id]").attr("data-devoir-id");this.nom=$(e).find(".devoir-name").val();this.groupe=$(e).find(".devoir-groupe").find("input:checked").val();this.fichiers=new Array;var t=$(e).find(".fichiers").children(".fichier");for(var n=0;n<t.length;n++){var r=new Fichier;r.getInfos(t[n]);this.fichiers.push(r)}return this}}function Matiere(){this.id;this.nom;this.devoirs;this.loadInfos=function(){this.id=$("[data-matiere-id]").attr("data-matiere-id");this.nom=$("#matiere-name").val();this.devoirs=new Array;var e=$("#devoirs").children(".devoir");for(var t=0;t<e.length;t++){var n=new Devoir;n.getInfos(e[t]);this.devoirs.push(n)}};this.getJSON=function(){return JSON.stringify(this)};this.loadInfos()}function sendJSON(){event.preventDefault();var e=new Matiere;$.ajax({url:"/Users/Cours?i="+e.id,type:"POST",data:{jsonData:e.getJSON()},success:function(e){var e=JSON.parse(e);e.result=="ok"?$.UIkit.notify({message:"Le cours à bien été modifié",status:"success",timeout:5e3,pos:"top-right"}):$.UIkit.notify({message:"Erreur : "+e.result,status:"danger",timeout:5e3,pos:"top-right"})}});return!1}function getTemplateFichier(){}function addFichier(){var e=$(this).parents(".devoir").find(".fichiers");$(e).append(gen.templateFichier())}function addDevoir(){$(".well").append(gen.templateDevoir())}function IdGen(){this.id_d=0;this.id_f=0;this.templateFichier=function(){this.id_f--;return $("#fichier-template").html().replace(new RegExp("{id_f}","g"),this.id_f)};this.templateDevoir=function(){this.id_d--;this.id_f--;return $("#devoir-template").html().replace(new RegExp("{id_d}","g"),this.id_d).replace(new RegExp("{id_f}","g"),this.id_f)}}$(document).ready(function(){gen=new IdGen;$(".btn-fichier").click(addFichier);$(".btn-devoir").click(addDevoir)});